<!DOCTYPE html>
<html>
<head>
    <title>Task Management System</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">Task Management</h1>
        <div id="taskForm">
            <form id="addTaskForm" autocomplete="off">
                <div class="form-group">
                    <label for="taskType">Type</label>
                    <select class="form-control" id="taskType" required>
                        <option value="Task">Task</option>
                        <option value="Bug">Bug</option>
                        <option value="Feature">Feature</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="taskSummary">Summary</label>
                    <input type="text" class="form-control" id="taskSummary" required>
                </div>
                <div class="form-group">
                    <label for="taskStatus">Status</label>
                    <select class="form-control" id="taskStatus" required>
                        <option value="TODO">TODO</option>
                        <option value="In Progress">In Progress</option>
                        <option value="DONE">Done</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Add Task</button>
                <button type="button" id="cancelForm" class="btn btn-secondary ml-2">Cancel</button>
            </form>
        </div>
        <div id="taskTable" class="mt-5">
            <h2 class="text-center mb-3">Task List</h2>
            <table class="table table-borderend">
                <thead>
                    <tr>
                        <th>Type</th>
                        <th>Key</th>
                        <th>Summary</th>
                        <th>Assignee</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="taskList">
                    <!-- Tasks will be appended here -->
                </tbody>
            </table>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <!-- Place your script AFTER jQuery and at the END of body -->
    <script>
    // Code Generated by Sidekick is for learning and experimentation purposes only.
    let taskID = 1;

    function getTypeIcon(type) {
        switch (type) {
            case 'Task':
                return '<i class="fas fa-tasks" style="color:gold;"></i>';
            case 'Bug':
                return '<i class="fas fa-bug" style="color:red;"></i>';
            case 'Feature':
                return '<i class="fas fa-star" style="color:blue;"></i>';
            default:
                return '';
        }
    }

    function saveTasks(tasks) {
        localStorage.setItem('tasks', JSON.stringify(tasks));
    }

    function loadTasks() {
        const tasks = localStorage.getItem('tasks');
        return tasks ? JSON.parse(tasks) : [];
    }

    function renderTasks(tasks) {
        $('#taskList').empty();
        tasks.forEach(task => {
            const taskRow = `
                <tr>
                    <td>${getTypeIcon(task.type)} ${task.type}</td>
                    <td>${task.key}</td>
                    <td>${task.summary}</td>
                    <td>${task.assignee}</td>
                    <td class="task-status">${task.status}</td>
                </tr>
            `;
            $('#taskList').append(taskRow);
        });
    }

    // No $(document).ready needed since script is at end of body
    let tasks = loadTasks();
    if (tasks.length > 0) {
        const lastTask = tasks[tasks.length - 1];
        const lastID = parseInt(lastTask.key.split('-')[1], 10);
        if (!isNaN(lastID)) taskID = lastID + 1;
    }
    renderTasks(tasks);

    // Cancel button handler
    $('#cancelForm').on('click', function(e) {
        e.preventDefault();
        $('#taskType').val('Task');
        $('#taskSummary').val('');
        $('#taskStatus').val('TODO');
    });

    // Form submit handler
    $('#addTaskForm').on('submit', function(event) {
        event.preventDefault();

        const taskType = $('#taskType').val();
        const taskSummary = $('#taskSummary').val();
        const taskStatus = $('#taskStatus').val();
        const taskKey = `AJ-${taskID++}`;
        const taskAssignee = 'Ajay Tanguturi';

        if (!taskSummary.trim()) {
            alert('Summary cannot be empty.');
            return;
        }

        const newTask = {
            type: taskType,
            key: taskKey,
            summary: taskSummary,
            assignee: taskAssignee,
            status: taskStatus
        };

        tasks.push(newTask);
        saveTasks(tasks);
        renderTasks(tasks);

        // Reset the form fields
        $('#taskType').val('Task');
        $('#taskSummary').val('');
        $('#taskStatus').val('TODO');
    });
    </script>
</body>
</html>
